
%%% N= 512 xm= .336

%% nr = 1.3

err512_0336_130_000100 = 100.*abs(maxpol_tm5123360130001 - maxparpol512_0336_130_000100)./maxpol_tm5123360130001


err512_0336_130_000438 = 100.*abs(maxpol_tm512336013000438 - maxparpol512_0336_130_000438)./maxpol_tm512336013000438

    %0.0226
err512_0336_130_002260 = 100.*abs(maxpol_tm51233601300226 - maxparpol512_0336_130_002260)./maxpol_tm51233601300226

 %0.09
err512_0336_130_009000 = 100.*abs(maxpol_tm512336013009 - maxparpol512_0336_130_009000)./maxpol_tm512336013009

% nr = 1.71
err512_0336_171_002260 = 0

err512_0336_171_009000 = 0

%nr = 2.0

err512_0336_200_002260 = 100.*abs(maxpol_tm51233602000226 - maxparpol512_0336_200_002260)./maxpol_tm51233602000226


err512_0336_200_009000 = 100.*abs(maxpol_tm512336020009 - maxparpol512_0336_200_009000)./maxpol_tm512336020009

%% N= 512 xm= .64

%% nr = 1.3

err512_0640_130_000100 = 0
err512_0640_130_000438 = 0

    % ni=0.0226
err512_0640_130_002260 = 100.*abs(maxpol_tm51263981300226 - maxparpol512_0640_130_002260)./maxpol_tm51263981300226

    %ni=0.045
    err512_0640_130_004500 = 100.*abs(maxpol_tm5126398130045 - maxparpol512_0640_130_004520)./maxpol_tm5126398130045
    
    %ni+0.09

err512_0640_130_009000 = 100.*abs(maxpol_tm512639813009 - maxparpol512_0640_130_009000)./maxpol_tm512639813009

%% nr = 1.71
    
    %0.0226
err512_0640_171_002260 = 100.*abs(maxpol_tm512639817100226 - maxparpol512_0640_171_002260)./maxpol_tm512639817100226
    
    %0.045
err512_0640_171_004500 = 100.*abs(maxpol_tm5126398171045 - maxparpol512_0640_171_004520)./maxpol_tm5126398171045

    %0.09
    err512_0640_171_009000 = 100.*abs(maxpol_tm5126398171009 - maxparpol512_0640_171_009000)./maxpol_tm5126398171009

%% nr = 2.0

    %0.0226
    err512_0640_200_002260 = 100.*abs(maxpol_tm51263982000226 - maxparpol512_0640_200_002260)./maxpol_tm51263982000226
    
    %0.045
    
    err512_0640_200_004500 = 100.*abs(maxpol_tm5126398200045 - maxparpol512_0640_200_004520)./maxpol_tm5126398200045
    
    %0.09
    err512_0640_200_009000 = 100.*abs(maxpol_tm512639820009 - maxparpol512_0640_200_009000)./maxpol_tm512639820009

%% 
nr13 = [ 1.3, 1.3, 1.3]
nr17 = [1.71, 1.71, 1.71] 
nr20 = [2.0, 2.0, 2.0]
ni13= [ 0.0226, 0.045, 0.09]
ni17= [0.0226, 0.045, 0.09] 
ni20= [ 0.0226, 0.045, 0.09 ]
%err3d336= [err512_0336_130_000100, err512_0336_130_000438, err512_0336_130_002260, err512_0336_130_009000, 0, 0, err512_0336_200_002260, err512_0336_200_009000]
err3d6413 = [err512_0640_130_002260, err512_0640_130_004500, err512_0640_130_009000]
err3d6417 = [err512_0640_171_002260, err512_0640_171_004500, err512_0640_171_009000]
err3d6420 = [err512_0640_200_002260, err512_0640_200_004500, err512_0640_200_009000]

figure1 = figure
%stem3(n_i,n_r,err336);
%hold on
stem3(ni13, nr13, err3d6413, '.')
hold on
stem3(ni17, nr17, err3d6417, '.')
stem3(ni20, nr20, err3d6420, '.')
title('N= 512 x_m = 0.64 - Max. Polarization Error')
legend('n_r = 1.3', 'n_r = 1.7', 'n_r = 2.0')
hold off

%errbphs5123360130001 = 100*abs(S11avg5123360130001(181) - par512_0336_130_000100_P11(181))/S11avg5123360130001(181)
%errbphs512336013000438 = 100*abs(S11avg512336013000438(181) - par512_0336_130_000438_P11(181))/S11avg512336013000438(181)
%errbphs51233601300226 = 100*abs(S11avg51233601300226(181) - par512_0336_130_002260_P11(181))/S11avg51233601300226(181)
%errbphs512336013009 = 100*abs(S11avg512336013009(181) - par512_0336_130_009000_P11(181))/S11avg512336013009(181)
%errbphs512336017100226 = 0 % 100*(S11avg512336017100226(181) - par512_0336_171_002260_P11(181))/S11avg512336017100226(181)
%errbphs5123360171045 = 0 %100*(S11avg5123360171045(181) - par512_0336_171_004520_P11(181))/S11avg5123360171045(181)
%errbphs51233602000226 = 100*abs(S11avg51233602000226(181) - par512_0336_200_002260_P11(181))/S11avg51233602000226(181)
%errbphs512336020009 = 100*abs(S11avg512336020009(181) - par512_0336_200_009000_P11(181))/S11avg512336020009(181)

% xm = 0.64

% errbphs5126398130001 = 0 %100*(S11avg5126398130001(181) - par512_0640_130_000100_P11(181))/S11avg5126398130001(181)
% errbphs512639813000438 = 0 % 100*(S11avg512639813000438(181) - par512_0640_130_000438_P11(181))/S11avg512639813000438(181)
% errbphs51263981300226 = 100*abs(S11avg51263981300226(181) - par512_0640_130_002260_P11(181))/S11avg51263981300226(181)
% errbphs512639813009 = 100*abs(S11avg512639813009(181) - par512_0640_130_009000_P11(181))/S11avg512639813009(181)
% errbphs512639817100226 = 100*abs(S11avg512639817100226(181) - par512_0640_171_002260_P11(181))/S11avg512639817100226(181)
% errbphs5126398171045 = 100*abs(S11avg5126398171045(181) - par512_0640_171_004520_P11(181))/S11avg5126398171045(181)
% errbphs51263982000226 = 100*abs(S11avg51263982000226(181) - par512_0640_200_002260_P11(181))/S11avg51263982000226(181)
% errbphs512639820009 = 100*abs(S11avg512639820009(181) - par512_0640_200_009000_P11(181))/S11avg512639820009(181)

% errbphs336 = [errbphs5123360130001, errbphs512336013000438, errbphs51233601300226, errbphs512336013009, 0, 0, errbphs51233602000226, errbphs512336020009]
% errbphs64 = [0, 0, errbphs51263981300226, errbphs512639813009, errbphs512639817100226, errbphs5126398171045, errbphs51263982000226, errbphs512639820009]

%  %%% N= 512 xm= .336
%  
%  %% nr = 1.3
%  
%  errbphs512_0336_130_000100 = 100.*abs(back_tm5123360130001 - back_par512_0336_130_000100)./back_tm5123360130001
%  
%  
%  errbphs512_0336_130_000438 = 100.*abs(back_tm512336013000438 - back_par512_0336_130_000438)./back_tm512336013000438
%  
%      %0.0226
%  errbphs512_0336_130_002260 = 100.*abs(back_tm51233601300226 - back_par512_0336_130_002260)./back_tm51233601300226
%  
%   %0.09
%  errbphs512_0336_130_009000 = 100.*abs(back_tm512336013009 - back_par512_0336_130_009000)./back_tm512336013009
%  
%  % nr = 1.71
%  errbphs512_0336_171_002260 = 0
%  
%  errbphs512_0336_171_009000 = 0
%  
%  %nr = 2.0
%  
%  errbphs512_0336_200_002260 = 100.*abs(back_tm51233602000226 - back_par512_0336_200_002260)./back_tm51233602000226
%  
%  
%  errbphs512_0336_200_009000 = 100.*abs(back_tm512336020009 - back_par512_0336_200_009000)./back_tm512336020009

%% N= 512 xm= .64
err3d6413 = [err512_0640_130_002260, err512_0640_130_004500, err512_0640_130_009000]
err3d6417 = [err512_0640_171_002260, err512_0640_171_004500, err512_0640_171_009000]
err3d6420 = [err512_0640_200_002260, err512_0640_200_004500, err512_0640_200_009000]
%% nr = 1.3 back_par1024_0168_166_000200

errbphs512_0640_130_000100 = 0
errbphs512_0640_130_000438 = 0

    % ni=0.0226
errbphs512_0640_130_002260 = 100.*abs(back_tm51263981300226 - back_par512_0640_130_002260)./back_tm51263981300226

    %ni=0.045
    errbphs512_0640_130_004500 = 100.*abs(back_tm5126398130045 - back_par512_0640_130_004520)./back_tm5126398130045
    
    %ni+0.09

errbphs512_0640_130_009000 = 100.*abs(back_tm512639813009 - back_par512_0640_130_009000)./back_tm512639813009

%% nr = 1.71
    
    %0.0226
errbphs512_0640_171_002260 = 100.*abs(back_tm512639817100226 - back_par512_0640_171_002260)./back_tm512639817100226
    
    %0.045
errbphs512_0640_171_004500 = 100.*abs(back_tm5126398171045 - back_par512_0640_171_004520)./back_tm5126398171045

    %0.09
    errbphs512_0640_171_009000 = 100.*abs(back_tm5126398171009 - back_par512_0640_171_009000)./back_tm5126398171009

%% nr = 2.0

    %0.0226
    errbphs512_0640_200_002260 = 100.*abs(back_tm51263982000226 - back_par512_0640_200_002260)./back_tm51263982000226
    
    %0.045
    
    errbphs512_0640_200_004500 = 100.*abs(back_tm5126398200045 - back_par512_0640_200_004520)./back_tm5126398200045
    
    %0.09
    errbphs512_0640_200_009000 = 100.*abs(back_tm512639820009 - back_par512_0640_200_009000)./back_tm512639820009

%% 
nr13 = [ 1.3, 1.3, 1.3]
nr17 = [1.71, 1.71, 1.71] 
nr20 = [2.0, 2.0, 2.0]
ni13= [ 0.0226, 0.045, 0.09]
ni17= [0.0226, 0.045, 0.09] 
ni20= [ 0.0226, 0.045, 0.09 ]
%errbphs3d336= [errbphs512_0336_130_000100, errbphs512_0336_130_000438, errbphs512_0336_130_002260, errbphs512_0336_130_009000, 0, 0, errbphs512_0336_200_002260, errbphs512_0336_200_009000]
errbphs3d6413 = [errbphs512_0640_130_002260, errbphs512_0640_130_004500, errbphs512_0640_130_009000]
errbphs3d6417 = [errbphs512_0640_171_002260, errbphs512_0640_171_004500, errbphs512_0640_171_009000]
errbphs3d6420 = [errbphs512_0640_200_002260, errbphs512_0640_200_004500, errbphs512_0640_200_009000]

figure2 = figure
%stem3(n_i,n_r,errbphs336);
%hold on
stem3(ni13, nr13, errbphs3d6413, '.')
hold on
stem3(ni17, nr17, errbphs3d6417, '.')
stem3(ni20, nr20, errbphs3d6420, '.')
title('N= 512 x_m = 0.64 - Exact Backscattering Errors')
legend('n_r = 1.3', 'n_r = 1.7', 'n_r = 2.0')
hold off

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Qe Error 

%% nr = 1.3 ParQe1024_0168_166_000200

errQe512_0640_130_000100 = 0
errQe512_0640_130_000438 = 0

    % ni=0.0226
errQe512_0640_130_002260 = 100.*abs(Qeavg51263981300226 - ParQe512_0640_130_002260)./Qeavg51263981300226

    %ni=0.045
    errQe512_0640_130_004500 = 100.*abs(Qeavg5126398130045 - ParQe512_0640_130_004520)./Qeavg5126398130045
    
    %ni+0.09

errQe512_0640_130_009000 = 100.*abs(Qeavg512639813009 - ParQe512_0640_130_009000)./Qeavg512639813009

%% nr = 1.71
    
    %0.0226
errQe512_0640_171_002260 = 100.*abs(Qeavg512639817100226 - ParQe512_0640_171_002260)./Qeavg512639817100226
    
    %0.045
errQe512_0640_171_004500 = 100.*abs(Qeavg5126398171045 - ParQe512_0640_171_004520)./Qeavg5126398171045

    %0.09
    errQe512_0640_171_009000 = 100.*abs(Qeavg5126398171009 - ParQe512_0640_171_009000)./Qeavg5126398171009

%% nr = 2.0

    %0.0226
    errQe512_0640_200_002260 = 100.*abs(Qeavg51263982000226 - ParQe512_0640_200_002260)./Qeavg51263982000226
    
    %0.045
    
    errQe512_0640_200_004500 = 100*abs((Qeavg5126398200045 - ParQe512_0640_200_004520)/Qeavg5126398200045)
    
    %0.09
    errQe512_0640_200_009000 = 100.*abs(Qeavg512639820009 - ParQe512_0640_200_009000)./Qeavg512639820009

%% 
nr13 = [ 1.3, 1.3, 1.3]
nr17 = [1.71, 1.71, 1.71] 
nr20 = [2.0, 2.0, 2.0]
ni13= [ 0.0226, 0.045, 0.09]
ni17= [0.0226, 0.045, 0.09] 
ni20= [ 0.0226, 0.045, 0.09 ]
%errQe3d336= [errQe512_0336_130_000100, errQe512_0336_130_000438, errQe512_0336_130_002260, errQe512_0336_130_009000, 0, 0, errQe512_0336_200_002260, errQe512_0336_200_009000]
errQe3d6413 = [errQe512_0640_130_002260, errQe512_0640_130_004500, errQe512_0640_130_009000]
errQe3d6417 = [errQe512_0640_171_002260, errQe512_0640_171_004500, errQe512_0640_171_009000]
errQe3d6420 = [errQe512_0640_200_002260, errQe512_0640_200_004500, errQe512_0640_200_009000]

figure3 = figure
%stem3(n_i,n_r,errQe336);
%hold on
stem3(ni13, nr13, errQe3d6413, '.')
hold on
stem3(ni17, nr17, errQe3d6417, '.')
stem3(ni20, nr20, errQe3d6420, '.')
title('N= 512 x_m = 0.64 - Extinction Efficiency Error')
legend('n_r = 1.3', 'n_r = 1.7', 'n_r = 2.0')
hold off


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%555
% Qa Error


%% nr = 1.3 ParQa1024_0168_166_000200

errQa512_0640_130_000100 = 0
errQa512_0640_130_000438 = 0

    % ni=0.0226
errQa512_0640_130_002260 = 100.*abs(Qabsavg51263981300226 - ParQa512_0640_130_002260)./Qabsavg51263981300226

    %ni=0.045
    errQa512_0640_130_004500 = 100.*abs(Qabsavg5126398130045 - ParQa512_0640_130_004520)./Qabsavg5126398130045
    
    %ni+0.09

errQa512_0640_130_009000 = 100.*abs(Qabsavg512639813009 - ParQa512_0640_130_009000)./Qabsavg512639813009

%% nr = 1.71
    
    %0.0226
errQa512_0640_171_002260 = 100.*abs(Qabsavg512639817100226 - ParQa512_0640_171_002260)./Qabsavg512639817100226
    
    %0.045
errQa512_0640_171_004500 = 100.*abs(Qabsavg5126398171045 - ParQa512_0640_171_004520)./Qabsavg5126398171045

    %0.09
    errQa512_0640_171_009000 = 100.*abs(Qabsavg5126398171009 - ParQa512_0640_171_009000)./Qabsavg5126398171009

%% nr = 2.0

    %0.0226
    errQa512_0640_200_002260 = 100.*abs(Qabsavg51263982000226 - ParQa512_0640_200_002260)./Qabsavg51263982000226
    
    %0.045
    
    errQa512_0640_200_004500 = 100.*abs(Qabsavg5126398200045 - ParQa512_0640_200_004520)./Qabsavg5126398200045
    
    %0.09
    errQa512_0640_200_009000 = 100.*abs(Qabsavg512639820009 - ParQa512_0640_200_009000)./Qabsavg512639820009

%% 
nr13 = [ 1.3, 1.3, 1.3]
nr17 = [1.71, 1.71, 1.71] 
nr20 = [2.0, 2.0, 2.0]
ni13= [ 0.0226, 0.045, 0.09]
ni17= [0.0226, 0.045, 0.09] 
ni20= [ 0.0226, 0.045, 0.09 ]
%errQa3d336= [errQa512_0336_130_000100, errQa512_0336_130_000438, errQa512_0336_130_002260, errQa512_0336_130_009000, 0, 0, errQa512_0336_200_002260, errQa512_0336_200_009000]
errQa3d6413 = [errQa512_0640_130_002260, errQa512_0640_130_004500, errQa512_0640_130_009000]
errQa3d6417 = [errQa512_0640_171_002260, errQa512_0640_171_004500, errQa512_0640_171_009000]
errQa3d6420 = [errQa512_0640_200_002260, errQa512_0640_200_004500, errQa512_0640_200_009000]

figure4 = figure
%stem3(n_i,n_r,errQa336);
%hold on
stem3(ni13, nr13, errQa3d6413, '.')
hold on
stem3(ni17, nr17, errQa3d6417, '.')
stem3(ni20, nr20, errQa3d6420, '.')
title('N= 512 x_m = 0.64 - Absorption Efficiency Error')
legend('n_r = 1.3', 'n_r = 1.7', 'n_r = 2.0')
hold off

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Qs Error


%% nr = 1.3 ParQs1024_0168_166_000200

errQs512_0640_130_000100 = 0
errQs512_0640_130_000438 = 0

    % ni=0.0226
errQs512_0640_130_002260 = 100.*abs(Qscaavg51263981300226 - ParQs512_0640_130_002260)./Qscaavg51263981300226

    %ni=0.045
    errQs512_0640_130_004500 = 100.*abs(Qscaavg5126398130045 - ParQs512_0640_130_004520)./Qscaavg5126398130045
    
    %ni+0.09

errQs512_0640_130_009000 = 100.*abs(Qscaavg512639813009 - ParQs512_0640_130_009000)./Qscaavg512639813009

%% nr = 1.71
    
    %0.0226
errQs512_0640_171_002260 = 100.*abs(Qscaavg512639817100226 - ParQs512_0640_171_002260)./Qscaavg512639817100226
    
    %0.045
errQs512_0640_171_004500 = 100.*abs(Qscaavg5126398171045 - ParQs512_0640_171_004520)./Qscaavg5126398171045

    %0.09
    errQs512_0640_171_009000 = 100.*abs(Qscaavg5126398171009 - ParQs512_0640_171_009000)./Qscaavg5126398171009

%% nr = 2.0

    %0.0226
    errQs512_0640_200_002260 = 100.*abs(Qscaavg51263982000226 - ParQs512_0640_200_002260)./Qscaavg51263982000226
    
    %0.045
    
    errQs512_0640_200_004500 = 100.*abs(Qscaavg5126398200045 - ParQs512_0640_200_004520)./Qscaavg5126398200045
    
    %0.09
    errQs512_0640_200_009000 = 100.*abs(Qscaavg512639820009 - ParQs512_0640_200_009000)./Qscaavg512639820009

%% 
nr13 = [ 1.3, 1.3, 1.3]
nr17 = [1.71, 1.71, 1.71] 
nr20 = [2.0, 2.0, 2.0]
ni13= [ 0.0226, 0.045, 0.09]
ni17= [0.0226, 0.045, 0.09] 
ni20= [ 0.0226, 0.045, 0.09 ]
%errQs3d336= [errQs512_0336_130_000100, errQs512_0336_130_000438, errQs512_0336_130_002260, errQs512_0336_130_009000, 0, 0, errQs512_0336_200_002260, errQs512_0336_200_009000]
errQs3d6413 = [errQs512_0640_130_002260, errQs512_0640_130_004500, errQs512_0640_130_009000]
errQs3d6417 = [errQs512_0640_171_002260, errQs512_0640_171_004500, errQs512_0640_171_009000]
errQs3d6420 = [errQs512_0640_200_002260, errQs512_0640_200_004500, errQs512_0640_200_009000]

figure5 = figure
%stem3(n_i,n_r,errQs336);
%hold on
stem3(ni13, nr13, errQs3d6413, '.')
hold on
stem3(ni17, nr17, errQs3d6417, '.')
stem3(ni20, nr20, errQs3d6420, '.')
title('N= 512 x_m = 0.64 - Scattering Efficiency Error')
legend('n_r = 1.3', 'n_r = 1.7', 'n_r = 2.0')
hold off
